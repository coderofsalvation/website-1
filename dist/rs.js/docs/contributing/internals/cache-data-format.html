<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Data format of the local cache | remoteStorage</title>
    <meta name="description" content="An open protocol for per-user storage on the Web">
    <meta name="generator" content="VitePress v1.2.3">
    <link rel="preload stylesheet" href="/assets/style.D99TCAyq.css" as="style">
    
    <script type="module" src="/assets/app.BWAVgVJ1.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.Bi9zwDUp.js">
    <link rel="modulepreload" href="/assets/chunks/theme.BmIJF09B.js">
    <link rel="modulepreload" href="/assets/rs.js_docs_contributing_internals_cache-data-format.md.BvQi4sP-.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar has-sidebar top" data-v-7ad780c2 data-v-844edcde><div class="wrapper" data-v-844edcde><div class="container" data-v-844edcde><div class="title" data-v-844edcde><div class="VPNavBarTitle has-sidebar" data-v-844edcde data-v-0ad69264><a class="title" href="/" data-v-0ad69264><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.svg" alt data-v-ab19afbb><!--]--><span data-v-0ad69264>remoteStorage</span><!--[--><!--]--></a></div></div><div class="content" data-v-844edcde><div class="content-body" data-v-844edcde><!--[--><!--]--><div class="VPNavBarSearch search" data-v-844edcde><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-844edcde data-v-f732b5d0><span id="main-nav-aria-label" class="visually-hidden" data-v-f732b5d0>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-f732b5d0 data-v-08fbf4b6><!--[--><span data-v-08fbf4b6>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/get.html" tabindex="0" data-v-f732b5d0 data-v-08fbf4b6><!--[--><span data-v-08fbf4b6>Getting started</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/rs.js/docs.html" tabindex="0" data-v-f732b5d0 data-v-08fbf4b6><!--[--><span data-v-08fbf4b6>remoteStorage.js</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://community.remotestorage.io" target="_blank" rel="noreferrer" tabindex="0" data-v-f732b5d0 data-v-08fbf4b6><!--[--><span data-v-08fbf4b6>Forums</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-844edcde data-v-283b26e9><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-283b26e9 data-v-7df97737 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-7df97737></span><span class="vpi-moon moon" data-v-7df97737></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-844edcde data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/remotestorage" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-github" /></a><a class="VPSocialLink no-icon" href="https://kosmos.social/@remotestorage" aria-label="mastodon" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-mastodon" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-844edcde data-v-8e87c032 data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-af5898d3><span class="vpi-more-horizontal icon" data-v-af5898d3></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-e42ed9b3><!----><!--[--><!--[--><!----><div class="group" data-v-8e87c032><div class="item appearance" data-v-8e87c032><p class="label" data-v-8e87c032>Appearance</p><div class="appearance-action" data-v-8e87c032><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-8e87c032 data-v-7df97737 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-7df97737></span><span class="vpi-moon moon" data-v-7df97737></span><!--]--></span></span></button></div></div></div><div class="group" data-v-8e87c032><div class="item social-links" data-v-8e87c032><div class="VPSocialLinks social-links-list" data-v-8e87c032 data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/remotestorage" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-github" /></a><a class="VPSocialLink no-icon" href="https://kosmos.social/@remotestorage" aria-label="mastodon" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-mastodon" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-844edcde data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-844edcde><div class="divider-line" data-v-844edcde></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-883964e0><button data-v-883964e0>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-4871f9f5><div class="curtain" data-v-4871f9f5></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-4871f9f5><span class="visually-hidden" id="sidebar-aria-label" data-v-4871f9f5> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-4871f9f5><div class="VPSidebarItem level-0 is-link" data-v-4871f9f5 data-v-c24f735a><div class="item" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>remoteStorage.js</p><!--]--></a><!----></div><!----></div></div><div class="group" data-v-4871f9f5><section class="VPSidebarItem level-0" data-v-4871f9f5 data-v-c24f735a><div class="item" role="button" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><h2 class="text" data-v-c24f735a>Guide</h2><!----></div><div class="items" data-v-c24f735a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/why.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Why use this?</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed is-link" data-v-c24f735a data-v-c24f735a><div class="item" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/getting-started/" data-v-c24f735a><!--[--><h3 class="text" data-v-c24f735a>Getting started</h3><!--]--></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c24f735a><span class="vpi-chevron-right caret-icon" data-v-c24f735a></span></div></div><div class="items" data-v-c24f735a><!--[--><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/getting-started/how-to-add.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Adding rs.js to an app</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/getting-started/initialize-and-configure.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Initialization & configuration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/getting-started/connect-widget.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Using the connect widget add-on</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/getting-started/events.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Handling events</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/getting-started/dropbox-and-google-drive.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Offering Dropbox and Google Drive options</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/getting-started/read-and-write-data.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Reading and writing data</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed is-link" data-v-c24f735a data-v-c24f735a><div class="item" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/data-modules/" data-v-c24f735a><!--[--><h3 class="text" data-v-c24f735a>Data modules</h3><!--]--></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c24f735a><span class="vpi-chevron-right caret-icon" data-v-c24f735a></span></div></div><div class="items" data-v-c24f735a><!--[--><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/data-modules/defining-a-module.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Defining a module</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/data-modules/defining-data-types.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Defining data types</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/data-modules/publishing-and-finding-modules.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Publishing and finding modules</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/nodejs.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Usage with Node.js</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/cordova.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Usage in Cordova apps</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/typescript.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Usage with TypeScript</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-4871f9f5><section class="VPSidebarItem level-0 is-link" data-v-4871f9f5 data-v-c24f735a><div class="item" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/api.html" data-v-c24f735a><!--[--><h2 class="text" data-v-c24f735a>JavaScript API</h2><!--]--></a><!----></div><div class="items" data-v-c24f735a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/api/remotestorage/classes/RemoteStorage.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>RemoteStorage</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/api/baseclient/classes/BaseClient.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>BaseClient</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/api/access/classes/Access.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Access</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/api/caching/classes/Caching.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Caching</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-4871f9f5><section class="VPSidebarItem level-0 collapsible is-link has-active" data-v-4871f9f5 data-v-c24f735a><div class="item" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/" data-v-c24f735a><!--[--><h2 class="text" data-v-c24f735a>Contributing</h2><!--]--></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c24f735a><span class="vpi-chevron-right caret-icon" data-v-c24f735a></span></div></div><div class="items" data-v-c24f735a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/code-overview.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Code overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/building.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Building</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/testing.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Testing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/docs.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Documentation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/github-flow.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>GitHub workflow</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/release-checklist.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Release checklist</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible is-link has-active" data-v-c24f735a data-v-c24f735a><div class="item" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/internals/" data-v-c24f735a><!--[--><h3 class="text" data-v-c24f735a>Library internals</h3><!--]--></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c24f735a><span class="vpi-chevron-right caret-icon" data-v-c24f735a></span></div></div><div class="items" data-v-c24f735a><!--[--><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/internals/discovery-bootstrap.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Discovery bootstrap</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/internals/caching.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Caching</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/rs.js/docs/contributing/internals/cache-data-format.html" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>Data format of the local cache</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _rs_js_docs_contributing_internals_cache-data-format external-link-icon-enabled" data-v-e6f2a212><div><h1 id="data-format-of-the-local-cache" tabindex="-1">Data format of the local cache <a class="header-anchor" href="#data-format-of-the-local-cache" aria-label="Permalink to &quot;Data format of the local cache&quot;">​</a></h1><p>This section describes the structure and concepts of the local cache.</p><h2 id="storing-up-to-4-revisions-of-each-node" tabindex="-1">Storing up to 4 revisions of each node <a class="header-anchor" href="#storing-up-to-4-revisions-of-each-node" aria-label="Permalink to &quot;Storing up to 4 revisions of each node&quot;">​</a></h2><p>Each cache node represents the versioning state of either one document or one folder. The versioning state is represented by one or more of the <code>common</code>, <code>local</code>, <code>remote</code>, and <code>push</code> revisions. Local changes are stored in <code>local</code>, and in <code>push</code> while an outgoing request is active. Remote changes that have either not been fetched yet, or have not been merged with local changes yet, are stored in <code>remote</code>.</p><h2 id="automerge" tabindex="-1">autoMerge <a class="header-anchor" href="#automerge" aria-label="Permalink to &quot;autoMerge&quot;">​</a></h2><p>The <code>sync.autoMerge</code> function will try to merge local and remote changes into the common revision of a node. It may emit change events with a &#39;conflict&#39; origin to indicate that an unpushed local change was overruled by a remote change.</p><p>When consulting the base client about the current value of a node, you will get either its &#39;local&#39; revision if it exists, or its &#39;common&#39; revision otherwise. The following are versioning tree diagrams of how local and remote revisions of a node can interact:</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//in sync:</span></span>
<span class="line"><span>1)  . . . . [common]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//dirty:</span></span>
<span class="line"><span>2)  . . . . [common]</span></span>
<span class="line"><span>                \</span></span>
<span class="line"><span>                 \ . . . . [remote]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//local change:</span></span>
<span class="line"><span>3)  . . . . [common] . . . . [local]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//conflict (should autoMerge):</span></span>
<span class="line"><span>4) . . . . [common] . . . . [local]</span></span>
<span class="line"><span>               \</span></span>
<span class="line"><span>                \ . . . . [remote]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//pushing:</span></span>
<span class="line"><span>5)  . . . . [common] . . . . [push] . . . . [local]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//pushing, and known dirty (should abort the push, or just wait for the conflict to occur):</span></span>
<span class="line"><span>6)  . . . . [common] . . . . [push] . . . . [local]</span></span>
<span class="line"><span>                \</span></span>
<span class="line"><span>                 \ . . . . [remote]</span></span></code></pre></div><p>Each of <code>local</code>, <code>push</code>, <code>remote</code>, and <code>common</code> can have have following properties:</p><ul><li>for documents: <ul><li>body</li><li>contentType</li><li>contentLength</li><li>revision</li><li>timestamp</li></ul></li><li>for folders: <ul><li>itemsMap (itemName -&gt; true, or itemName -&gt; false to indicate an unmerged deletion)</li><li>revision</li><li>timestamp</li></ul></li></ul><p>NB: The timestamp represents the last sync time, not the last modified time. It is used by the <code>isOutdated</code> function in <code>src/cachinglayer.js</code> to determine if the data needs to be fetched from remote again, or can be served from cache.</p><h2 id="keep-revert-conflict-resolution" tabindex="-1">&quot;keep/revert&quot; conflict resolution <a class="header-anchor" href="#keep-revert-conflict-resolution" aria-label="Permalink to &quot;\&quot;keep/revert\&quot; conflict resolution&quot;">​</a></h2><p>RemoteStorage implements a hub-and-spokes versioning system, with one central remoteStorage server (the hub) and any number of clients (the spokes). The clients will typically be unhosted web apps based on this JS lib (remotestorage.js), but they don&#39;t have to be; they can also be based on other client implementations, they can be hosted web apps, desktop apps, native smartphone apps, etcetera. New versions of subtrees always start at one of these clients. They are then sent to the server, and from there to all the other clients. The server assigns the revision numbers and sends them to the initiating client using HTTP ETag response headers in response to PUT requests. remotestorage.js is a library that attempts to make it easy to build remoteStorage applications, by hiding both the push/pull synchronization and the version merging from the app developer. Versioning conflicts between the local client and the remote server are initially resolved as a &#39;remote wins&#39;, to which the client code may respond with an explicit revert (putting the old, local version back), any type of custom merge (putting the result of the merge in place), or by doing nothing (&quot;keep&quot;), and leaving the remote result in place. This system is called &quot;keep/revert&quot;, since the library takes a pro-active action (&#39;remote wins&#39;), which the app can then either keep, or revert.</p><p>Sync is tree-based: syncing a node is equivalent to syncing all its children. There are two parts at play, that interact: transporting the diffs to and from the remote server, and merging the local and remote versions into one common version. Each document starts out as non-existing in both its local and remote versions. From there on, it can be created, updated, and deleted any number of times throughout its history, both locally and remotely. If at some point in time it either does not exist neither locally nor remotely, or its body and content-type are the same byte-for-byte on both sides, then the two stores are in agreement. If the document exists in only one of the stores, or the document&#39;s body or its content-type differs between the two stores, then the document is in conflict.</p><p>The library is always aware of the latest local version, but it may or may not be aware of the latest remote version, and therefore of whether a conflict or agreement exists for the document. Likewise, the server is not necessarily aware of the latest local version, if there are changes that haven&#39;t been pushed out yet; nor does it care, though, since the server does not get involved in conflict resolution. It only serializes conditional updates from all clients into one canonical versioning history.</p><p>The lack of sync between client and server can be fixed by doing a GET, PUT, or DELETE. A GET will return the current remote version; a conditional PUT or DELETE will push out the change, while at the same time checking if any unfetched remote changes exist. If they do, then the push will fail, and the library will fetch instead. After this, the library has a latest known common revision of the document, possibly a local version if it was changed since then, and possibly a remote version if it was changed since then, but the newer version has yet to be retrieved.</p><p>Before resolving a conflict, both revision histories are squashed. This means that creating+deleting a document becomes a noop, and deleting+creating, or updating it multiple times, becomes one single update. Then, if the document was changed in different ways locally and remotely, it goes into conflict state; if it was changed only locally or only remotely, then the change is automatically accepted by the other store (whether client to server or server to client). Note that in the case of a successful conditional push request, this will already have happened.</p><p>Conflicts that are discovered by a document fetch, fire their &#39;keep/revert&#39; event immediately. Conflicts that are discovered through a parent folder fetch, or through a conditional push, fire their &#39;keep/revert&#39; event after the new remote version is fetched.</p><p>The library&#39;s conflict resolution strategy is &#39;remote wins&#39;. This means that the module will receive them in the form of change events with origin &#39;conflict&#39;. When receiving such a change event, the module can still decide to revert it explicitly.</p><p>As noted before, merging a subtree is done by merging each document that exists within that subtree, in either or both stores. When the library fetches a folder listing, it can detect a remote child change, which then may or may not result in a conflict. When a folder listing comes in, which has changed since the last time it was retrieved, four types of information may be discovered:</p><ul><li>which of the documents directly within the folder changed their remote revision since the last check (new ETag on a document item)</li><li>in which previously empty subtrees at least one document was created (new folder item)</li><li>in which subtrees all previously existing documents were deleted (folder item disappeared)</li><li>in which subtrees at least one document was either created, updated, or deleted (new ETag on a folder item)</li></ul><p>All of these can occur in a folder that was at the same time either unchanged, updated, or deleted locally. When updated, it might be that different items were changed locally and remotely, or that the same item was changed on both sides, either in the same way, or in different ways.</p><p>The library handles all these cases so the module developer does not need to worry about them.</p><h2 id="implications-for-module-design" tabindex="-1">Implications for module design <a class="header-anchor" href="#implications-for-module-design" aria-label="Permalink to &quot;Implications for module design&quot;">​</a></h2><p>There are a number of important implications for module design:</p><ul><li>First of all, this sync process follows the &#39;asynchronous synchronization&#39; design principle (<a href="https://github.com/offlinefirst/research/issues/9" target="_blank" rel="noreferrer">https://github.com/offlinefirst/research/issues/9</a>). Don&#39;t wait for it to finish. The module should work with the local copy of the data, and handle incoming updates through evented programming. The only exception to this is where a body of data is too big to cache locally, and the module needs to expose on-demand access of remote data to the app. In all other cases, the module should expose the local version as &#39;the truth&#39;.</li><li>Even then, IndexedDB is not fast enough to access from a button click. Make sure to put an in-memory caching layer in the module, and return control to the app immediately. An example of this approach is the SyncedMap data structure used in <a href="https://github.com/michielbdejong/meute" target="_blank" rel="noreferrer">https://github.com/michielbdejong/meute</a>.</li><li>Use folders and subfolders. This allows the tree-based sync algorithm to shine and efficiently detect changes in any of potentially thousands of documents by checking the ETag from one single HTTP request to the root folder of the tree.</li><li>Use meaningful collections. Multiple clients can each edit a different document without ever entering in conflict with each other. But editing the same document is interpreted as a conflict. For instance, when two calendar apps both schedule an event on a certain date, this would be a conflict if the module stores one document per day. However, if the module stores one document per event, and instead uses one /folder/ for each day, then the two events can co-exist on the same day without generating a conflict. Documents are a unit of conflict, but folders are not. Another example is storing todo-list items with long UUID hashes instead of their list index numbers as document names. Editing item &quot;5&quot; would conflict with inserting a new item &quot;5&quot;. But if both items have a long unique name, then they don&#39;t clash with each other. So make sure to choose unique item names for items that should not conflict.</li></ul></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-5941af80><!--[--><!--]--><div class="edit-info" data-v-5941af80><div class="edit-link" data-v-5941af80><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/remotestorage/remotestorage.js/edit/master/rs.js/docs/contributing/internals/cache-data-format.md" target="_blank" rel="noreferrer" data-v-5941af80><!--[--><span class="vpi-square-pen edit-link-icon" data-v-5941af80></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-5941af80><span class="visually-hidden" id="doc-footer-aria-label" data-v-5941af80>Pager</span><div class="pager" data-v-5941af80><a class="VPLink link pager-link prev" href="/rs.js/docs/contributing/internals/caching.html" data-v-5941af80><!--[--><span class="desc" data-v-5941af80>Previous page</span><span class="title" data-v-5941af80>Caching</span><!--]--></a></div><div class="pager" data-v-5941af80><!----></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"rs.js_docs_api_remotestorage_index.md\":\"DdxehIy4\",\"rs.js_docs_data-modules_publishing-and-finding-modules.md\":\"CcXrnXCX\",\"rs.js_docs_why.md\":\"CKXUVVI3\",\"rs.js_docs_api_access_index.md\":\"CeR1dGmM\",\"rs.js_docs_data-modules_index.md\":\"BVyk3F-F\",\"rs.js_docs_contributing_building.md\":\"BMB_8HXi\",\"rs.js_docs_api_caching_index.md\":\"DgkmDvgg\",\"unhosted.md\":\"Cckz-pqj\",\"rs.js_docs_data-modules_defining-a-module.md\":\"D4j5oM9S\",\"rs.js_docs_api_index.md\":\"BJ9MI915\",\"rs.js_docs_contributing_github-flow.md\":\"BaNcqjNL\",\"rs.js_docs_contributing_testing.md\":\"Dlrg-Ycn\",\"rs.js_docs_getting-started_events.md\":\"29DFBqc3\",\"rs.js_docs_api_caching_classes_caching.md\":\"ni5wQItu\",\"rs.js_docs_contributing_code-overview.md\":\"Cp0LHON4\",\"rs.js_docs_getting-started_index.md\":\"CKusuCiv\",\"rs.js_docs_getting-started_how-to-add.md\":\"D0Y7xYuO\",\"rs.js_docs_contributing_index.md\":\"Dsknq_gC\",\"rs.js_docs_contributing_docs.md\":\"B_QcXrcd\",\"rs.js_docs_api_remotestorage_classes_remotestorage.md\":\"BQC1_1b4\",\"rs.js_docs_typescript.md\":\"C78Xeb2O\",\"rs.js_docs_getting-started_dropbox-and-google-drive.md\":\"D1c1VVWu\",\"rs.js_docs_api_access_classes_access.md\":\"CB8gYP-_\",\"rs.js_docs_api_modules.md\":\"BNt_YUKp\",\"rs.js.index.md\":\"Q6uIJZkr\",\"rs.js_docs_nodejs.md\":\"sMbujoIE\",\"servers.md\":\"BRTr2YK8\",\"rs.js_docs_getting-started_connect-widget.md\":\"Dg5lR6MW\",\"design.md\":\"DIrhXPBV\",\"rs.js_docs_contributing_internals_cache-data-format.md\":\"BvQi4sP-\",\"rs.js_docs_api_baseclient_classes_baseclient.md\":\"BAoiWA3d\",\"index.md\":\"-jpHZ3h5\",\"rs.js_docs_cordova.md\":\"v_apYhkA\",\"contribute.md\":\"DFjsTlLH\",\"rs.js_docs_api_baseclient_index.md\":\"DNr7VUxJ\",\"rs.js_docs_contributing_release-checklist.md\":\"D-3CM5Y2\",\"readme.md\":\"CuXk9i92\",\"rs.js_docs_index.md\":\"BRanaW6z\",\"rs.js_docs_contributing_internals_caching.md\":\"CZuabFq9\",\"get.md\":\"rS5Vi1U9\",\"rs.js_docs_getting-started_read-and-write-data.md\":\"CuhtiKzh\",\"protocol.md\":\"DYc3ZfDY\",\"rs.js_docs_data-modules_defining-data-types.md\":\"C_dFn_Pz\",\"apps.md\":\"JKIQnzmx\",\"rs.js_docs_getting-started_initialize-and-configure.md\":\"DUS9FTBq\",\"rs.js_docs_contributing_internals_discovery-bootstrap.md\":\"BWc71enq\",\"rs.js_docs_contributing_internals_index.md\":\"C0ciGOYJ\"}");function deserializeFunctions(r){return Array.isArray(r)?r.map(deserializeFunctions):typeof r=="object"&&r!==null?Object.keys(r).reduce((t,n)=>(t[n]=deserializeFunctions(r[n]),t),{}):typeof r=="string"&&r.startsWith("_vp-fn_")?new Function(`return ${r.slice(7)}`)():r};window.__VP_SITE_DATA__=deserializeFunctions(JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"remoteStorage\",\"description\":\"An open protocol for per-user storage on the Web\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.svg\",\"externalLinkIcon\":true,\"outline\":{\"level\":[2,3]},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Getting started\",\"link\":\"/get\"},{\"text\":\"remoteStorage.js\",\"link\":\"/rs.js/docs\"},{\"text\":\"Forums\",\"link\":\"https://community.remotestorage.io\"}],\"sidebar\":{\"/\":[{\"items\":[{\"text\":\"Getting started\",\"link\":\"/get\"},{\"text\":\"How it works\",\"items\":[{\"text\":\"Unhosted Web Apps\",\"link\":\"/unhosted\"},{\"text\":\"Protocol\",\"link\":\"/protocol\"}]},{\"text\":\"Apps\",\"link\":\"/apps\"},{\"text\":\"Servers\",\"link\":\"/servers\"},{\"text\":\"Contribute\",\"link\":\"/contribute\"},{\"text\":\"Design\",\"link\":\"/design\"}]}],\"/rs.js/\":[{\"text\":\"remoteStorage.js\",\"link\":\"/rs.js/docs/\",\"items\":[]},{\"text\":\"Guide\",\"items\":[{\"text\":\"Why use this?\",\"link\":\"/rs.js/docs/why\"},{\"text\":\"Getting started\",\"link\":\"/rs.js/docs/getting-started/\",\"collapsed\":true,\"items\":[{\"text\":\"Adding rs.js to an app\",\"link\":\"/rs.js/docs/getting-started/how-to-add\"},{\"text\":\"Initialization & configuration\",\"link\":\"/rs.js/docs/getting-started/initialize-and-configure\"},{\"text\":\"Using the connect widget add-on\",\"link\":\"/rs.js/docs/getting-started/connect-widget\"},{\"text\":\"Handling events\",\"link\":\"/rs.js/docs/getting-started/events\"},{\"text\":\"Offering Dropbox and Google Drive options\",\"link\":\"/rs.js/docs/getting-started/dropbox-and-google-drive\"},{\"text\":\"Reading and writing data\",\"link\":\"/rs.js/docs/getting-started/read-and-write-data\"}]},{\"text\":\"Data modules\",\"link\":\"/rs.js/docs/data-modules/\",\"collapsed\":true,\"items\":[{\"text\":\"Defining a module\",\"link\":\"/rs.js/docs/data-modules/defining-a-module\"},{\"text\":\"Defining data types\",\"link\":\"/rs.js/docs/data-modules/defining-data-types\"},{\"text\":\"Publishing and finding modules\",\"link\":\"/rs.js/docs/data-modules/publishing-and-finding-modules\"}]},{\"text\":\"Usage with Node.js\",\"link\":\"/rs.js/docs/nodejs\"},{\"text\":\"Usage in Cordova apps\",\"link\":\"/rs.js/docs/cordova\"},{\"text\":\"Usage with TypeScript\",\"link\":\"/rs.js/docs/typescript\"}]},{\"text\":\"JavaScript API\",\"link\":\"/rs.js/docs/api\",\"items\":[{\"text\":\"RemoteStorage\",\"link\":\"/rs.js/docs/api/remotestorage/classes/RemoteStorage\"},{\"text\":\"BaseClient\",\"link\":\"/rs.js/docs/api/baseclient/classes/BaseClient\"},{\"text\":\"Access\",\"link\":\"/rs.js/docs/api/access/classes/Access\"},{\"text\":\"Caching\",\"link\":\"/rs.js/docs/api/caching/classes/Caching\"}]},{\"text\":\"Contributing\",\"link\":\"/rs.js/docs/contributing/\",\"collapsed\":true,\"items\":[{\"text\":\"Code overview\",\"link\":\"/rs.js/docs/contributing/code-overview\"},{\"text\":\"Building\",\"link\":\"/rs.js/docs/contributing/building\"},{\"text\":\"Testing\",\"link\":\"/rs.js/docs/contributing/testing\"},{\"text\":\"Documentation\",\"link\":\"/rs.js/docs/contributing/docs\"},{\"text\":\"GitHub workflow\",\"link\":\"/rs.js/docs/contributing/github-flow\"},{\"text\":\"Release checklist\",\"link\":\"/rs.js/docs/contributing/release-checklist\"},{\"text\":\"Library internals\",\"link\":\"/rs.js/docs/contributing/internals/\",\"collapsed\":true,\"items\":[{\"text\":\"Discovery bootstrap\",\"link\":\"/rs.js/docs/contributing/internals/discovery-bootstrap\"},{\"text\":\"Caching\",\"link\":\"/rs.js/docs/contributing/internals/caching\"},{\"text\":\"Data format of the local cache\",\"link\":\"/rs.js/docs/contributing/internals/cache-data-format\"}]}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/remotestorage\"},{\"icon\":\"mastodon\",\"link\":\"https://kosmos.social/@remotestorage\"}],\"editLink\":{\"pattern\":\"_vp-fn_({ filePath }) => {\\n        if (filePath.startsWith(\\\"rs.js/\\\")) {\\n          return `https://github.com/remotestorage/remotestorage.js/edit/master/${filePath}`;\\n        } else {\\n          return `https://github.com/remotestorage/website/edit/master/${filePath}`;\\n        }\\n      }\"},\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}"));</script>
    
  </body>
</html>